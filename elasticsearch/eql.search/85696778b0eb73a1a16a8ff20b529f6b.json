{
  "api": "eql.search",
  "file": "/test/platinum/eql/70_functions_on_keys.yml",
  "name": "Test one join key",
  "origin": "yaml",
  "request": {
    "args": {
      "body": {
        "query": "sequence by source.ip with maxspan=5s [any where event.code : \"5145\" and winlog.computer_name == \"foo.bar.baz\" ] [any where winlog.computer_name == \"foo.bar.baz\" and startswith(winlog.computer_name, substring(user.name, 0, -1)) ]"
      },
      "index": "eql_test"
    }
  },
  "response": {
    "headers": {
      "content-length": "665",
      "content-type": "application/json",
      "x-elastic-product": "Elasticsearch"
    },
    "payload": {
      "hits": {
        "sequences": [
          {
            "events": [
              {
                "_id": "1",
                "_index": "eql_test",
                "_source": {
                  "@timestamp": "2025-06-18T12:21:37.018Z",
                  "event": {
                    "category": "authentication",
                    "code": "5145"
                  },
                  "source": {
                    "ip": "192.168.56.200"
                  },
                  "user": {
                    "domain": "bar.baz",
                    "name": "something"
                  },
                  "winlog": {
                    "computer_name": "foo.bar.baz"
                  }
                }
              },
              {
                "_id": "2",
                "_index": "eql_test",
                "_source": {
                  "@timestamp": "2025-06-18T12:21:37.093Z",
                  "event": {
                    "category": "authentication"
                  },
                  "source": {
                    "ip": "192.168.56.200"
                  },
                  "user": {
                    "domain": "BAR.BAZ",
                    "name": "foo$"
                  },
                  "winlog": {
                    "computer_name": "foo.bar.baz"
                  }
                }
              }
            ],
            "join_keys": [
              "192.168.56.200"
            ]
          }
        ],
        "total": {
          "relation": "eq",
          "value": 1
        }
      },
      "is_partial": false,
      "is_running": false,
      "timed_out": false,
      "took": 37
    },
    "statusCode": 200
  }
}